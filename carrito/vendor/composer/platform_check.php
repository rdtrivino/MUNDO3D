<?php

// platform_check.php @generated by Composer

// Inicializa un array vacío para almacenar posibles problemas detectados
$issues = array();

// Verifica si la versión de PHP es menor a 5.6.0
if (!(PHP_VERSION_ID >= 50600)) {
    // Si la versión de PHP es menor a 5.6.0, agrega un mensaje de error al array de problemas
    $issues[] = 'Your Composer dependencies require a PHP version ">= 5.6.0". You are running ' . PHP_VERSION . '.';
}

// Si existen problemas en el array $issues
if ($issues) {
    // Si los encabezados HTTP no se han enviado aún, envía un encabezado de error 500
    if (!headers_sent()) {
        header('HTTP/1.1 500 Internal Server Error');
    }
    // Verifica si la directiva `display_errors` está desactivada
    if (!ini_get('display_errors')) {
        // Si se ejecuta en CLI o phpdbg, muestra los problemas en STDERR
        if (PHP_SAPI === 'cli' || PHP_SAPI === 'phpdbg') {
            fwrite(STDERR, 'Composer detected issues in your platform:' . PHP_EOL.PHP_EOL . implode(PHP_EOL, $issues) . PHP_EOL.PHP_EOL);
        // Si no se han enviado encabezados, muestra los problemas como salida estándar
        } elseif (!headers_sent()) {
            echo 'Composer detected issues in your platform:' . PHP_EOL.PHP_EOL . str_replace('You are running '.PHP_VERSION.'.', '', implode(PHP_EOL, $issues)) . PHP_EOL.PHP_EOL;
        }
    } 
    // Dispara un error de usuario con los problemas detectados
    trigger_error(
        'Composer detected issues in your platform: ' . implode(' ', $issues),
        E_USER_ERROR
    );
}

